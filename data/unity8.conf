description "Unity Shell v8"
author "Ricardo Mendoza <ricmm@ubuntu.com>"

start on ((xsession SESSION=ubuntu-touch) or (xsession SESSION=ubuntu-touch-surfaceflinger)) and started dbus
stop on desktop-end

respawn

pre-start script
    if [ -n "$MIR_SOCKET" ]; then
        # Point unity8 at unity-system-compositor
        initctl set-env MIR_SERVER_HOST_SOCKET=$MIR_SOCKET
        initctl set-env MIR_SERVER_FILE=$XDG_RUNTIME_DIR/mir_socket
        # Point all future jobs in this session to our Mir socket instead of
        # unity-system-compositor's socket.
        initctl set-env --global MIR_SOCKET=$XDG_RUNTIME_DIR/mir_socket
    fi
end script

exec ${BINARY:-unity8} $ARGS
